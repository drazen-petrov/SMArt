

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>SMArt.md.gromos.md_functions.make_imd &mdash; SMArt v1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
        <script src="../../../../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../index.html" class="icon icon-home"> SMArt
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../modules.html">SMArt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../Tutorial/index.html">Tutorial</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">SMArt</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../../../md.html">SMArt.md</a> &raquo;</li>
        
      <li>SMArt.md.gromos.md_functions.make_imd</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for SMArt.md.gromos.md_functions.make_imd</h1><div class="highlight"><pre>
<span></span><span class="n">_disres_block</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;DISTANCERES</span>
<span class="s2">#   NTDIR -2..2 controls distance restraining</span>
<span class="s2">#         0: no distrance restraining (default)</span>
<span class="s2">#         1: instantaneous, using force constant CDIR</span>
<span class="s2">#         2: instantaneous, using force constant CDIR x W0</span>
<span class="s2">#        -1: time-averaged, using force constant CDIR</span>
<span class="s2">#        -2: time-averaged, using force constant CDIR x W0</span>
<span class="s2">#  NTDIRA 0,1 controls values for initial distance averages</span>
<span class="s2">#         0: generate initial averages</span>
<span class="s2">#         1: read from configuration</span>
<span class="s2">#    CDIR &gt;= 0.0 force constant for distance restraining</span>
<span class="s2">#    DIR0 &gt; 0.0 distance offset in restraining function</span>
<span class="s2">#  TAUDIR &gt;= 0.0 coupling time for time averaging</span>
<span class="s2"># FORCESCALE 0..2 controls approximation of force scaling</span>
<span class="s2">#         0: approximate d&lt;r&gt;/dr = 1</span>
<span class="s2">#         1: approximate d&lt;r&gt;/dr = (1.0 - exp(-Dt/tau))</span>
<span class="s2">#         2: use d&lt;r&gt;/dr = (1.0 - exp(-Dt/tau))*(&lt;r&gt;/r)^4</span>
<span class="s2">#    VDIR 0,1 controls contribution to virial</span>
<span class="s2">#         0: no contribution</span>
<span class="s2">#         1: distance restraints contribute to virial</span>
<span class="s2">#  NTWDIR &gt;= 0 write every NTWDIRth step dist. restr. information to external file</span>
<span class="s2">#   NTDIR  NTDIRA    CDIR    DIR0  TAUDIR  FORCESCALE  VDIR  NTWDIR</span>
<span class="s2">        2       0     1.0     1.0     1.0           0     0       0</span>
<span class="s2">END&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">_add_imd_blocks</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dsr&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">_disres_block</span>
    <span class="k">return</span> <span class="n">s</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>


<div class="viewcode-block" id="get_emin_missing_at_imd"><a class="viewcode-back" href="../../../../../SMArt.md.gromos.md_functions.html#SMArt.md.gromos.md_functions.make_imd.get_emin_missing_at_imd">[docs]</a><span class="k">def</span> <span class="nf">get_emin_missing_at_imd</span><span class="p">(</span><span class="n">n_atoms</span><span class="p">,</span> <span class="n">box_type</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;TITLE</span>
<span class="s2">Energy minimisation of 1pyo_l1A in vacuum</span>
<span class="s2">Created 2017-05-10 13:24:42</span>
<span class="s2">END</span>
<span class="s2">SYSTEM</span>
<span class="s2">#      NPM      NSM</span>
<span class="s2">         1      0</span>
<span class="s2">END</span>
<span class="s2">ENERGYMIN</span>
<span class="s2">#     NTEM    NCYC    DELE    DX0     DXM   NMIN   FLIM</span>
<span class="s2">         1       1     0.001     0.01    0.05   1000   0.0</span>
<span class="s2">END</span>
<span class="s2">STEP</span>
<span class="s2">#   NSTLIM         T        DT</span>
<span class="s2">   5000      0.202      0.002</span>
<span class="s2">END</span>
<span class="s2">INITIALISE</span>
<span class="s2">#    NTIVEL   NTISHK   NTINHT    NTINHB    NTISHI  NTIRTC     NTICOM   NTISTI      IG     TEMPI</span>
<span class="s2">      0       0        0         0         1       0          0        0       184930     298.15</span>
<span class="s2">END</span>
<span class="s2">BOUNDCOND</span>
<span class="s2">#      NTB    NDFMIN</span>
<span class="s2">       &quot;&quot;&quot;</span> <span class="o">+</span> <span class="n">box_type</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;      1</span>
<span class="s2">END</span>
<span class="s2">FORCE</span>
<span class="s2">#      NTF array</span>
<span class="s2"># bonds    angles    imp.     dihe     charge nonbonded</span>
<span class="s2"># H        H         H        H</span>
<span class="s2">     1        1         1        1     0  0</span>
<span class="s2"># NEGR    NRE(1)    NRE(2)    ...      NRE(NEGR)</span>
<span class="s2">    1 &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n_atoms</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">END</span>
<span class="s2"># use the shake algorithm to constrain the bond lengths.</span>
<span class="s2">CONSTRAINT</span>
<span class="s2">#      NTC       NTCP   NTCP0(1)     NTCS      NTCS0(1)</span>
<span class="s2">         0          1    0.00010        1      0.00010</span>
<span class="s2">END</span>
<span class="s2">PAIRLIST</span>
<span class="s2">#    algorithm: standard (0) (gromos96 like pairlist)</span>
<span class="s2">#                     grid (1) (XX grid pairlist)</span>
<span class="s2">#    SIZE:       grid cell size (or auto = 0.5 * RCUTP)</span>
<span class="s2">#    TYPE:       chargegoup (0) (chargegroup based cutoff)</span>
<span class="s2">#                     atomic (1) (atom based cutoff)</span>
<span class="s2">#</span>
<span class="s2">#    algorithm    NSNB    RCUTP    RCUTL    SIZE    TYPE</span>
<span class="s2">            0      5      0.8      1.4     0.4     0</span>
<span class="s2">END</span>
<span class="s2">NONBONDED</span>
<span class="s2"># NLRELE    APPAK      RCRF     EPSRF  NSLFEXCL</span>
<span class="s2">       1      0.0       1.4          1     1</span>
<span class="s2"># NSHAPE   ASHAPE    NA2CLC   TOLA2   EPSLS</span>
<span class="s2">       -1       1.4        2   1e-10       0</span>
<span class="s2"># NKX    NKY   NKZ    KCUT</span>
<span class="s2">   10     10    10     100</span>
<span class="s2"># NGX   NGY   NGZ  NASORD  NFDORD   NALIAS  NSPORD</span>
<span class="s2">   32    32    32       3       2        3       4</span>
<span class="s2"># NQEVAL   FACCUR   NRDGRD   NWRGRD   NLRLJ    SLVDNS</span>
<span class="s2">  100000      1.6        0        0       0      33.3</span>
<span class="s2">END</span>
<span class="s2">COMTRANSROT</span>
<span class="s2">#   NSCM</span>
<span class="s2">    0</span>
<span class="s2">END</span>
<span class="s2">PRINTOUT</span>
<span class="s2">#NTPR: print out energies, etc. every NTPR steps</span>
<span class="s2">#NTPP: =1 perform dihedral angle transition monitoring</span>
<span class="s2">#     NTPR          NTPP</span>
<span class="s2">        10          0</span>
<span class="s2">END</span>
<span class="s2">POSITIONRES</span>
<span class="s2"># values for NTPOR:</span>
<span class="s2">#  0: no position re(con)straining</span>
<span class="s2">#  1: use CPOR</span>
<span class="s2">#  2: use SPOR/ ATOMIC B-FACTORS</span>
<span class="s2">#  3: position constraining</span>
<span class="s2"># NTPOR       NTPORB     NTPORS      CPOR</span>
<span class="s2">      3            1          0     2.5E4</span>
<span class="s2">END</span>
<span class="s2">COVALENTFORM</span>
<span class="s2">#    NTBBH    NTBAH     NTBDN</span>
<span class="s2">         0         0         0</span>
<span class="s2">END</span>
<span class="s2">WRITETRAJ</span>
<span class="s2">#    NTWX     NTWSE      NTWV      NTWF      NTWE      NTWG      NTWB</span>
<span class="s2">      0         0         0         0         0         0         0</span>
<span class="s2">END</span>
<span class="s2">INNERLOOP</span>
<span class="s2">        0  0  0</span>
<span class="s2">END</span>
<span class="s2">ROTTRANS</span>
<span class="s2">#      RTC   RTCLAST</span>
<span class="s2">       0      &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n_atoms</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">END</span>
<span class="s2">&quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">+=</span> <span class="n">_add_imd_blocks</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span></div>


<div class="viewcode-block" id="get_emin_vac_imd"><a class="viewcode-back" href="../../../../../SMArt.md.gromos.md_functions.html#SMArt.md.gromos.md_functions.make_imd.get_emin_vac_imd">[docs]</a><span class="k">def</span> <span class="nf">get_emin_vac_imd</span><span class="p">(</span><span class="n">n_atoms</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;TITLE</span>
<span class="s2">Energy minimisation of 1pyo_l1A in vacuum</span>
<span class="s2">Created 2017-05-10 13:24:42</span>
<span class="s2">END</span>
<span class="s2">SYSTEM</span>
<span class="s2">#      NPM      NSM</span>
<span class="s2">         1      0</span>
<span class="s2">END</span>
<span class="s2">ENERGYMIN</span>
<span class="s2">#     NTEM    NCYC    DELE    DX0     DXM   NMIN   FLIM</span>
<span class="s2">         1       1     0.001     0.01    0.05   1000   0.0</span>
<span class="s2">END</span>
<span class="s2">STEP</span>
<span class="s2">#   NSTLIM         T        DT</span>
<span class="s2">   5000         0.0      0.002</span>
<span class="s2">END</span>
<span class="s2">INITIALISE</span>
<span class="s2">#    NTIVEL   NTISHK   NTINHT    NTINHB    NTISHI  NTIRTC     NTICOM   NTISTI      IG     TEMPI</span>
<span class="s2">      0       0        0         0         1       0          0        0       184930     298.15</span>
<span class="s2">END</span>
<span class="s2">BOUNDCOND</span>
<span class="s2">#      NTB    NDFMIN</span>
<span class="s2">       0      1</span>
<span class="s2">END</span>
<span class="s2">FORCE</span>
<span class="s2">#      NTF array</span>
<span class="s2"># bonds    angles    imp.     dihe     charge nonbonded</span>
<span class="s2"># H        H         H        H</span>
<span class="s2">     0        1         1        1     1  1</span>
<span class="s2"># NEGR    NRE(1)    NRE(2)    ...      NRE(NEGR)</span>
<span class="s2">    1 &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n_atoms</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">END</span>
<span class="s2"># use the shake algorithm to constrain the bond lengths.</span>
<span class="s2">CONSTRAINT</span>
<span class="s2">#      NTC       NTCP   NTCP0(1)     NTCS      NTCS0(1)</span>
<span class="s2">         3          1    0.00010        1      0.00010</span>
<span class="s2">END</span>
<span class="s2">PAIRLIST</span>
<span class="s2">#    algorithm: standard (0) (gromos96 like pairlist)</span>
<span class="s2">#                     grid (1) (XX grid pairlist)</span>
<span class="s2">#    SIZE:       grid cell size (or auto = 0.5 * RCUTP)</span>
<span class="s2">#    TYPE:       chargegoup (0) (chargegroup based cutoff)</span>
<span class="s2">#                     atomic (1) (atom based cutoff)</span>
<span class="s2">#</span>
<span class="s2">#    algorithm    NSNB    RCUTP    RCUTL    SIZE    TYPE</span>
<span class="s2">            0      5      0.8      1.4     0.4     0</span>
<span class="s2">END</span>
<span class="s2">NONBONDED</span>
<span class="s2"># NLRELE    APPAK      RCRF     EPSRF  NSLFEXCL</span>
<span class="s2">       1      0.0       1.4          1     1</span>
<span class="s2"># NSHAPE   ASHAPE    NA2CLC   TOLA2   EPSLS</span>
<span class="s2">       -1       1.4        2   1e-10       0</span>
<span class="s2"># NKX    NKY   NKZ    KCUT</span>
<span class="s2">   10     10    10     100</span>
<span class="s2"># NGX   NGY   NGZ  NASORD  NFDORD   NALIAS  NSPORD</span>
<span class="s2">   32    32    32       3       2        3       4</span>
<span class="s2"># NQEVAL   FACCUR   NRDGRD   NWRGRD   NLRLJ    SLVDNS</span>
<span class="s2">  100000      1.6        0        0       0      33.3</span>
<span class="s2">END</span>
<span class="s2">COMTRANSROT</span>
<span class="s2">#   NSCM</span>
<span class="s2">    0</span>
<span class="s2">END</span>
<span class="s2">PRINTOUT</span>
<span class="s2">#NTPR: print out energies, etc. every NTPR steps</span>
<span class="s2">#NTPP: =1 perform dihedral angle transition monitoring</span>
<span class="s2">#     NTPR          NTPP</span>
<span class="s2">        10          0</span>
<span class="s2">END</span>
<span class="s2">POSITIONRES</span>
<span class="s2"># values for NTPOR:</span>
<span class="s2">#  0: no position re(con)straining</span>
<span class="s2">#  1: use CPOR</span>
<span class="s2">#  2: use SPOR/ ATOMIC B-FACTORS</span>
<span class="s2">#  3: position constraining</span>
<span class="s2"># NTPOR       NTPORB     NTPORS      CPOR</span>
<span class="s2">      0            1          0     2.5E4</span>
<span class="s2">END</span>
<span class="s2">COVALENTFORM</span>
<span class="s2">#    NTBBH    NTBAH     NTBDN</span>
<span class="s2">         0         0         0</span>
<span class="s2">END</span>
<span class="s2">WRITETRAJ</span>
<span class="s2">#    NTWX     NTWSE      NTWV      NTWF      NTWE      NTWG      NTWB</span>
<span class="s2">      0         0         0         0         0         0         0</span>
<span class="s2">END</span>
<span class="s2">INNERLOOP</span>
<span class="s2">        0  0  0</span>
<span class="s2">END</span>
<span class="s2">ROTTRANS</span>
<span class="s2">#      RTC   RTCLAST</span>
<span class="s2">       0      &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n_atoms</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">END</span>
<span class="s2">&quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">+=</span> <span class="n">_add_imd_blocks</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span></div>


<div class="viewcode-block" id="get_emin_water_imd"><a class="viewcode-back" href="../../../../../SMArt.md.gromos.md_functions.html#SMArt.md.gromos.md_functions.make_imd.get_emin_water_imd">[docs]</a><span class="k">def</span> <span class="nf">get_emin_water_imd</span><span class="p">(</span><span class="n">n_atoms</span><span class="p">,</span> <span class="n">nW</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;TITLE</span>
<span class="s2">steepest descent energy minimization of the peptide in water</span>
<span class="s2">END</span>
<span class="s2">ENERGYMIN</span>
<span class="s2">#     NTEM    NCYC    DELE    DX0     DXM   NMIN   FLIM</span>
<span class="s2">         1       1      0.1   0.01    0.05   1000    0.0</span>
<span class="s2">END</span>
<span class="s2">SYSTEM</span>
<span class="s2">#      NPM      NSM</span>
<span class="s2">         1      &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nW</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">END</span>
<span class="s2">INITIALISE</span>
<span class="s2">#    NTIVEL   NTISHK   NTINHT    NTINHB    NTISHI  NTIRTC     NTICOM   NTISTI      IG     TEMPI</span>
<span class="s2">         0         0        0         0         1       0          0        0  210185     300.0</span>
<span class="s2">END</span>
<span class="s2"># do 2000 steps</span>
<span class="s2">STEP</span>
<span class="s2">#   NSTLIM         T        DT</span>
<span class="s2">      1000       0.0     0.002</span>
<span class="s2">END</span>
<span class="s2"># do it with rectangular periodic boundary conditions</span>
<span class="s2">BOUNDCOND</span>
<span class="s2">#      NTB    NDFMIN</span>
<span class="s2">         1         1</span>
<span class="s2">END</span>
<span class="s2"># every 10 steps print the energy in the output file.</span>
<span class="s2">PRINTOUT</span>
<span class="s2">#NTPR: print out energies, etc. every NTPR steps</span>
<span class="s2">#NTPP: =1 perform dihedral angle transition monitoring</span>
<span class="s2">#     NTPR          NTPP</span>
<span class="s2">        10             0</span>
<span class="s2">END</span>
<span class="s2"># use the shake algorithm to constrain the bond lengths.</span>
<span class="s2">CONSTRAINT</span>
<span class="s2">#      NTC       NTCP   NTCP0(1)     NTCS      NTCS0(1)</span>
<span class="s2">         3          1    0.00010        1      0.00010</span>
<span class="s2">END</span>
<span class="s2">FORCE</span>
<span class="s2">#      NTF array</span>
<span class="s2"># bonds    angles    imp.     dihe     charge nonbonded</span>
<span class="s2"># H        H         H        H</span>
<span class="s2">     0        1         1        1     1  1</span>
<span class="s2"># NEGR    NRE(1)    NRE(2)    ...      NRE(NEGR)</span>
<span class="s2">     2      &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n_atoms</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;      &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nW</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">n_atoms</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">END</span>
<span class="s2"># with rectangular periodic boundary conditions we may use</span>
<span class="s2"># the grid based pairlist generation</span>
<span class="s2">PAIRLIST</span>
<span class="s2">#	algorithm: standard (0) (gromos96 like pairlist)</span>
<span class="s2">#		             grid (1) (XX grid pairlist)</span>
<span class="s2">#	SIZE:	   grid cell size (or auto = 0.5 * RCUTP)</span>
<span class="s2">#	TYPE:	   chargegoup (0) (chargegroup based cutoff)</span>
<span class="s2">#			         atomic (1) (atom based cutoff)</span>
<span class="s2">#</span>
<span class="s2">#	algorithm	NSNB	RCUTP	RCUTL	SIZE	TYPE</span>
<span class="s2">	0               5	  0.8	  1.4	0.4     0</span>
<span class="s2">END</span>
<span class="s2">NONBONDED</span>
<span class="s2"># NLRELE    APPAK      RCRF     EPSRF  NSLFEXCL</span>
<span class="s2">       1      0.0       1.4        61     1</span>
<span class="s2"># NSHAPE   ASHAPE    NA2CLC   TOLA2   EPSLS</span>
<span class="s2">      -1       1.4        2   1e-10       0</span>
<span class="s2"># NKX    NKY   NKZ    KCUT</span>
<span class="s2">   10     10    10     100</span>
<span class="s2"># NGX   NGY   NGZ  NASORD  NFDORD   NALIAS  NSPORD</span>
<span class="s2">   32    32    32       3       2        3       4</span>
<span class="s2"># NQEVAL   FACCUR   NRDGRD   NWRGRD   NLRLJ    SLVDNS</span>
<span class="s2">  100000      1.6        0        0       0      33.3</span>
<span class="s2">END</span>
<span class="s2">POSITIONRES</span>
<span class="s2"># values for NTPOR:</span>
<span class="s2">#  0: no position re(con)straining</span>
<span class="s2">#  1: use CPOR</span>
<span class="s2">#  2: use SPOR/ ATOMIC B-FACTORS</span>
<span class="s2">#  3: position constraining</span>
<span class="s2"># NTPOR       NTPORB     NTPORS      CPOR</span>
<span class="s2">      0            1          0     2.5E4</span>
<span class="s2">END</span>
<span class="s2">&quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">+=</span> <span class="n">_add_imd_blocks</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span></div>


<div class="viewcode-block" id="get_eq_imd"><a class="viewcode-back" href="../../../../../SMArt.md.gromos.md_functions.html#SMArt.md.gromos.md_functions.make_imd.get_eq_imd">[docs]</a><span class="k">def</span> <span class="nf">get_eq_imd</span><span class="p">(</span><span class="n">n_atoms</span><span class="p">,</span> <span class="n">nW</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">gpu_flag</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;gpu_flag&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">gpu_flag</span><span class="p">:</span>
        <span class="n">inner_loop</span> <span class="o">=</span> <span class="s1">&#39;         4         0         1&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">inner_loop</span> <span class="o">=</span> <span class="s1">&#39;         2         1         0&#39;</span>
    <span class="n">NSCM</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NSCM&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;TITLE</span>
<span class="s2">equilibration of the peptide in water</span>
<span class="s2">END</span>
<span class="s2"># we have 1 solute and 908 solvent molecules</span>
<span class="s2">SYSTEM</span>
<span class="s2">#      NPM      NSM</span>
<span class="s2">         1      &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nW</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">END</span>
<span class="s2"># most of this block is overwritten by mkscript.</span>
<span class="s2">INITIALISE</span>
<span class="s2">#    NTIVEL   NTISHK   NTINHT    NTINHB    NTISHI  NTIRTC     NTICOM   NTISTI      IG     TEMPI</span>
<span class="s2">         0         0        0         0         1       0          0        0  210185       0.0</span>
<span class="s2">END</span>
<span class="s2"># do 50000 steps</span>
<span class="s2">STEP</span>
<span class="s2">#   NSTLIM         T        DT</span>
<span class="s2">     50000       0.0     0.002</span>
<span class="s2">END</span>
<span class="s2"># do it with rectangular periodic boundary conditions</span>
<span class="s2">BOUNDCOND</span>
<span class="s2">#      NTB     NDFMIN</span>
<span class="s2">         1         3</span>
<span class="s2">END</span>
<span class="s2"># couple the temperature, the temperatures are overwritten by mkscript.</span>
<span class="s2">MULTIBATH</span>
<span class="s2"># ALGORITHM:</span>
<span class="s2">#      weak-coupling(0):      use weak-coupling scheme</span>
<span class="s2">#      nose-hoover(1):        use Nose Hoover scheme</span>
<span class="s2">#      nose-hoover-chains(2): use Nose Hoover chains scheme</span>
<span class="s2"># NUM: number of chains in Nose Hoover chains scheme</span>
<span class="s2">#      !! only specify NUM when needed !!</span>
<span class="s2"># NBATHS: number of temperature baths to couple to</span>
<span class="s2">#          ALGORITHM</span>
<span class="s2">                   0</span>
<span class="s2">#  NBATHS</span>
<span class="s2">         2</span>
<span class="s2"># TEMP0(1 ... NBATHS)  TAU(1 ... NBATHS)</span>
<span class="s2">       300     0.1     300     0.1</span>
<span class="s2">#   DOFSET: number of distiguishable sets of d.o.f.</span>
<span class="s2">         2</span>
<span class="s2"># LAST(1 ... DOFSET)  COMBATH(1 ... DOFSET)  IRBATH(1 ... DOFSET)</span>
<span class="s2">       &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n_atoms</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;         1         1       &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nW</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">n_atoms</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;         2         2</span>
<span class="s2">END</span>
<span class="s2">PRESSURESCALE</span>
<span class="s2"># COUPLE   SCALE    COMP    TAUP  VIRIAL</span>
<span class="s2">       2       1 0.0004575      0.5       2</span>
<span class="s2"># SEMI</span>
<span class="s2">       1       1       1</span>
<span class="s2"># PRES0(1...3,1...3)</span>
<span class="s2"> 0.06102       0       0</span>
<span class="s2">       0 0.06102       0</span>
<span class="s2">       0       0 0.06102</span>
<span class="s2">END</span>
<span class="s2"># every 1000 step we remove only the translational com motion</span>
<span class="s2">COMTRANSROT</span>
<span class="s2">#   NSCM</span>
<span class="s2">    &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">NSCM</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">END</span>
<span class="s2">ROTTRANS</span>
<span class="s2">#      RTC   RTCLAST</span>
<span class="s2">       0      &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n_atoms</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">END</span>
<span class="s2">INNERLOOP</span>
<span class="s2">&quot;&quot;&quot;</span> <span class="o">+</span> <span class="n">inner_loop</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">END</span>
<span class="s2">COVALENTFORM</span>
<span class="s2"># NTBBH: 0,1 controls bond-stretching potential</span>
<span class="s2">#        0: quartic form (default)</span>
<span class="s2">#        1: harmonic form</span>
<span class="s2"># NTBAH: 0,1 controls bond-angle bending potential</span>
<span class="s2">#        0: cosine-harmonic (default)</span>
<span class="s2">#        1: harmonic</span>
<span class="s2"># NTBDN: 0,1 controls torsional dihedral potential</span>
<span class="s2">#        0: arbitrary phase shifts (default)</span>
<span class="s2">#        1: phase shifts limited to 0 and 180 degrees.</span>
<span class="s2">#   NTBBH    NTBAH    NTBDN</span>
<span class="s2">        0        0        0</span>
<span class="s2">END</span>
<span class="s2"># every 250 steps write the energy and coordinates to the</span>
<span class="s2"># trajectory</span>
<span class="s2">WRITETRAJ</span>
<span class="s2"># NTWSE = configuration selection parameter</span>
<span class="s2"># =0: write normal trajectory</span>
<span class="s2"># &gt;0: chose min energy for writing configurations</span>
<span class="s2">#     NTWX     NTWSE      NTWV      NTWF    NTWE      NTWG      NTWB</span>
<span class="s2">      5000         0         0         0    5000         0         0</span>
<span class="s2">END</span>
<span class="s2"># every 250 steps print the energy in the output file.</span>
<span class="s2">PRINTOUT</span>
<span class="s2">#NTPR: print out energies, etc. every NTPR steps</span>
<span class="s2">#NTPP: =1 perform dihedral angle transition monitoring</span>
<span class="s2">#     NTPR     NTPP</span>
<span class="s2">      5000        0</span>
<span class="s2">END</span>
<span class="s2"># calculate the energies between the peptide, the ions and the solvent.</span>
<span class="s2">FORCE</span>
<span class="s2"> # NTF(1..6): 0,1 determines terms used in force calculation</span>
<span class="s2">#             0: do not include terms</span>
<span class="s2">#             1: include terms</span>
<span class="s2"># NEGR: ABS(NEGR): number of energy groups</span>
<span class="s2">#             &gt; 0: use energy groups</span>
<span class="s2">#             &lt; 0: use energy and force groups</span>
<span class="s2"># NRE(1..NEGR): &gt;= 1.0 last atom in each energy group</span>
<span class="s2"># NTF(1) NTF(2) NTF(3) NTF(4) NTF(5)        NTF(6)</span>
<span class="s2"># bonds     angles    improper  dihedral  electrostatic vdW</span>
<span class="s2">  0         1         1         1         1             1</span>
<span class="s2"># NEGR    NRE(1)    NRE(2)    ...      NRE(NEGR)</span>
<span class="s2">     2      &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n_atoms</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;    &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nW</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">n_atoms</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">END</span>
<span class="s2"># use the shake algorithm to constrain the bond lengths.</span>
<span class="s2">CONSTRAINT</span>
<span class="s2">#      NTC       NTCP   NTCP0(1)     NTCS      NTCS0(1)</span>
<span class="s2">         3          1    0.00010       4</span>
<span class="s2">END</span>
<span class="s2"># use grid based pairlist generation to speed up</span>
<span class="s2">PAIRLIST</span>
<span class="s2">#	algorithm: standard(0) (gromos96 like pairlist)</span>
<span class="s2">#		             grid(1) (XX grid pairlist)</span>
<span class="s2">#	SIZE:	   grid cell size (or auto = 0.5 * RCUTP)</span>
<span class="s2">#	TYPE:	   chargegoup(0) (chargegroup based cutoff)</span>
<span class="s2">#			         atomic(1) (atom based cutoff)</span>
<span class="s2">#</span>
<span class="s2">#	algorithm	  NSNB	RCUTP	RCUTL	  SIZE	TYPE</span>
<span class="s2">	        1	   5	  0.8	  1.4	   0.4	   0</span>
<span class="s2">END</span>
<span class="s2"># Longrange reaction field correction</span>
<span class="s2">NONBONDED</span>
<span class="s2"># NLRELE    APPAK      RCRF     EPSRF   NSLFEXCL</span>
<span class="s2">       1      0.0       1.4        61    1</span>
<span class="s2"># NSHAPE   ASHAPE    NA2CLC   TOLA2   EPSLS</span>
<span class="s2">      -1       1.4        2   1e-10       0</span>
<span class="s2"># NKX    NKY   NKZ    KCUT</span>
<span class="s2">   10     10    10     100</span>
<span class="s2"># NGX   NGY   NGZ  NASORD  NFDORD   NALIAS  NSPORD</span>
<span class="s2">   32    32    32       3       2        3       4</span>
<span class="s2"># NQEVAL   FACCUR   NRDGRD   NWRGRD   NLRLJ    SLVDNS</span>
<span class="s2">  100000      1.6        0        0       0      33.3</span>
<span class="s2">END</span>
<span class="s2">POSITIONRES</span>
<span class="s2"># values for NTPOR:</span>
<span class="s2">#  0: no position re(con)straining</span>
<span class="s2">#  1: use CPOR</span>
<span class="s2">#  2: use SPOR/ ATOMIC B-FACTORS</span>
<span class="s2">#  3: position constraining</span>
<span class="s2"># NTPOR       NTPORB     NTPORS      CPOR</span>
<span class="s2">      1            1          0     2.5E4</span>
<span class="s2">END</span>
<span class="s2">&quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">+=</span> <span class="n">_add_imd_blocks</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span></div>


<div class="viewcode-block" id="get_ext_TI_imd"><a class="viewcode-back" href="../../../../../SMArt.md.gromos.md_functions.html#SMArt.md.gromos.md_functions.make_imd.get_ext_TI_imd">[docs]</a><span class="k">def</span> <span class="nf">get_ext_TI_imd</span><span class="p">(</span><span class="n">n_atoms</span><span class="p">,</span> <span class="n">nW</span><span class="p">,</span> <span class="n">bond_const</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">bond_const</span><span class="p">:</span>
        <span class="n">const_txt</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;#      NTC       NTCP   NTCP0(1)     NTCS      NTCS0(1)</span>
<span class="s2">         3          1    0.00010       4&quot;&quot;&quot;</span>
        <span class="n">force_txt</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">const_txt</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;#      NTC       NTCP   NTCP0(1)     NTCS      NTCS0(1)</span>
<span class="s2">         4          1    0.00010       4&quot;&quot;&quot;</span>
        <span class="n">force_txt</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;TITLE</span>
<span class="s2">extended TI</span>
<span class="s2">END</span>
<span class="s2"># we have 1 solute and 908 solvent molecules</span>
<span class="s2">SYSTEM</span>
<span class="s2">#      NPM      NSM</span>
<span class="s2">         1      &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nW</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">END</span>
<span class="s2"># most of this block is overwritten by mkscript.</span>
<span class="s2">INITIALISE</span>
<span class="s2">#    NTIVEL   NTISHK   NTINHT    NTINHB    NTISHI  NTIRTC     NTICOM   NTISTI      IG     TEMPI</span>
<span class="s2">         0         0        0         0         1       0          0        0  210185       0.0</span>
<span class="s2">END</span>
<span class="s2"># do 50000 steps</span>
<span class="s2">STEP</span>
<span class="s2">#   NSTLIM         T        DT</span>
<span class="s2">     50000       0.0     0.002</span>
<span class="s2">END</span>
<span class="s2"># do it with rectangular periodic boundary conditions</span>
<span class="s2">BOUNDCOND</span>
<span class="s2">#      NTB     NDFMIN</span>
<span class="s2">         1         3</span>
<span class="s2">END</span>
<span class="s2"># couple the temperature, the temperatures are overwritten by mkscript.</span>
<span class="s2">MULTIBATH</span>
<span class="s2"># ALGORITHM:</span>
<span class="s2">#      weak-coupling(0):      use weak-coupling scheme</span>
<span class="s2">#      nose-hoover(1):        use Nose Hoover scheme</span>
<span class="s2">#      nose-hoover-chains(2): use Nose Hoover chains scheme</span>
<span class="s2"># NUM: number of chains in Nose Hoover chains scheme</span>
<span class="s2">#      !! only specify NUM when needed !!</span>
<span class="s2"># NBATHS: number of temperature baths to couple to</span>
<span class="s2">#          ALGORITHM</span>
<span class="s2">                   0</span>
<span class="s2">#  NBATHS</span>
<span class="s2">         2</span>
<span class="s2"># TEMP0(1 ... NBATHS)  TAU(1 ... NBATHS)</span>
<span class="s2">       300     0.1     300     0.1</span>
<span class="s2">#   DOFSET: number of distiguishable sets of d.o.f.</span>
<span class="s2">         2</span>
<span class="s2"># LAST(1 ... DOFSET)  COMBATH(1 ... DOFSET)  IRBATH(1 ... DOFSET)</span>
<span class="s2">       &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n_atoms</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;         1         1       &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nW</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">n_atoms</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;         2         2</span>
<span class="s2">END</span>
<span class="s2">PRESSURESCALE</span>
<span class="s2"># COUPLE   SCALE    COMP    TAUP  VIRIAL</span>
<span class="s2">       2       1 0.0004575      0.5       2</span>
<span class="s2"># SEMI</span>
<span class="s2">       1       1       1</span>
<span class="s2"># PRES0(1...3,1...3)</span>
<span class="s2"> 0.06102       0       0</span>
<span class="s2">       0 0.06102       0</span>
<span class="s2">       0       0 0.06102</span>
<span class="s2">END</span>
<span class="s2"># every 1000 step we remove only the translational com motion</span>
<span class="s2">COMTRANSROT</span>
<span class="s2">#   NSCM</span>
<span class="s2">    1000</span>
<span class="s2">END</span>
<span class="s2">COVALENTFORM</span>
<span class="s2"># NTBBH: 0,1 controls bond-stretching potential</span>
<span class="s2">#        0: quartic form (default)</span>
<span class="s2">#        1: harmonic form</span>
<span class="s2"># NTBAH: 0,1 controls bond-angle bending potential</span>
<span class="s2">#        0: cosine-harmonic (default)</span>
<span class="s2">#        1: harmonic</span>
<span class="s2"># NTBDN: 0,1 controls torsional dihedral potential</span>
<span class="s2">#        0: arbitrary phase shifts (default)</span>
<span class="s2">#        1: phase shifts limited to 0 and 180 degrees.</span>
<span class="s2">#   NTBBH    NTBAH    NTBDN</span>
<span class="s2">        0        0        0</span>
<span class="s2">END</span>
<span class="s2">FORCE</span>
<span class="s2"> # NTF(1..6): 0,1 determines terms used in force calculation</span>
<span class="s2">#             0: do not include terms</span>
<span class="s2">#             1: include terms</span>
<span class="s2"># NEGR: ABS(NEGR): number of energy groups</span>
<span class="s2">#             &gt; 0: use energy groups</span>
<span class="s2">#             &lt; 0: use energy and force groups</span>
<span class="s2"># NRE(1..NEGR): &gt;= 1.0 last atom in each energy group</span>
<span class="s2"># NTF(1) NTF(2) NTF(3) NTF(4) NTF(5)        NTF(6)</span>
<span class="s2"># bonds     angles    improper  dihedral  electrostatic vdW</span>
<span class="s2">  &quot;&quot;&quot;</span> <span class="o">+</span> <span class="n">force_txt</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;         1         1         1         1             1</span>
<span class="s2"># NEGR    NRE(1)    NRE(2)    ...      NRE(NEGR)</span>
<span class="s2">     2      &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n_atoms</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;    &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nW</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">n_atoms</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">END</span>
<span class="s2"># use the shake algorithm to constrain the bond lengths.</span>
<span class="s2">CONSTRAINT</span>
<span class="s2">&quot;&quot;&quot;</span> <span class="o">+</span> <span class="n">const_txt</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">END</span>
<span class="s2">INNERLOOP</span>
<span class="s2">         2         1         0</span>
<span class="s2">END</span>
<span class="s2"># use grid based pairlist generation to speed up</span>
<span class="s2">PAIRLIST</span>
<span class="s2">#	algorithm: standard(0) (gromos96 like pairlist)</span>
<span class="s2">#		             grid(1) (XX grid pairlist)</span>
<span class="s2">#	SIZE:	   grid cell size (or auto = 0.5 * RCUTP)</span>
<span class="s2">#	TYPE:	   chargegoup(0) (chargegroup based cutoff)</span>
<span class="s2">#			         atomic(1) (atom based cutoff)</span>
<span class="s2">#</span>
<span class="s2">#	algorithm	  NSNB	RCUTP	RCUTL	  SIZE	TYPE</span>
<span class="s2">	        1	   5	  0.8	  1.4	   0.4	   0</span>
<span class="s2">END</span>
<span class="s2"># Longrange reaction field correction</span>
<span class="s2">NONBONDED</span>
<span class="s2"># NLRELE    APPAK      RCRF     EPSRF   NSLFEXCL</span>
<span class="s2">       1      0.0       1.4        61    1</span>
<span class="s2"># NSHAPE   ASHAPE    NA2CLC   TOLA2   EPSLS</span>
<span class="s2">       3       1.4        2   1e-10       0</span>
<span class="s2"># NKX    NKY   NKZ    KCUT</span>
<span class="s2">   10     10    10     100</span>
<span class="s2"># NGX   NGY   NGZ  NASORD  NFDORD   NALIAS  NSPORD</span>
<span class="s2">   32    32    32       3       2        3       4</span>
<span class="s2"># NQEVAL   FACCUR   NRDGRD   NWRGRD   NLRLJ    SLVDNS</span>
<span class="s2">  100000      1.6        0        0       0      33.3</span>
<span class="s2">END</span>
<span class="s2">PRINTOUT</span>
<span class="s2">#NTPR: print out energies, etc. every NTPR steps</span>
<span class="s2">#NTPP: =1 perform dihedral angle transition monitoring</span>
<span class="s2">#     NTPR      NTPP</span>
<span class="s2">      1000         0</span>
<span class="s2">END</span>
<span class="s2">WRITETRAJ</span>
<span class="s2">#    NTWX     NTWSE      NTWV      NTWF      NTWE      NTWG      NTWB</span>
<span class="s2">     1000         0         0         0        20        20         0</span>
<span class="s2">END</span>
<span class="s2">PERTURBATION</span>
<span class="s2">#    NTG: 0..1 controls use of free-energy calculation.</span>
<span class="s2">#         0: no free-energy calculation (default)</span>
<span class="s2">#         1: calculate dH/dRLAM</span>
<span class="s2">#  NRDGL: 0,1 controls reading of initial value for RLAM.</span>
<span class="s2">#         0: use initial RLAM parameter from PERTURBATION block</span>
<span class="s2">#         1: read from configuration</span>
<span class="s2">#   RLAM: 0.0..1.0 initial value for lambda</span>
<span class="s2">#  DLAMT: &gt;= 0.0 rate of lambda increase in time.</span>
<span class="s2"># ALPHLJ: &gt;= 0.0 Lennard-Jones soft-core parameter</span>
<span class="s2">#  ALPHC: &gt;= 0.0 Coulomb-RF soft-core parameter</span>
<span class="s2">#   NLAM: &gt; 0 power dependence of lambda coupling</span>
<span class="s2"># NSCALE: 0..2 controls use of interaction scaling</span>
<span class="s2">#         0: no interaction scaling</span>
<span class="s2">#         1: interaction scaling</span>
<span class="s2">#         2: perturbation for all atom pairs with scaled</span>
<span class="s2">#            interactions. No perturbation for others.</span>
<span class="s2">#</span>
<span class="s2">#     NTG   NRDGL    RLAM   DLAMT</span>
<span class="s2">        1       0     0.0     0.0</span>
<span class="s2">#  ALPHLJ   ALPHC    NLAM  NSCALE</span>
<span class="s2">      0.5     0.5       1       0</span>
<span class="s2">END</span>
<span class="s2">PRECALCLAM</span>
<span class="s2"># NRLAM   0  : off</span>
<span class="s2">#         &gt;1 : precalculating energies for NRLAM extra lambda values</span>
<span class="s2"># MINLAM  between 0 and 1: minimum lambda value to precalculate energies</span>
<span class="s2"># MAXLAM  between MINLAM and 1: maximum lambda value to precalculate energies</span>
<span class="s2"># NRLAM   MINLAM   MAXLAM</span>
<span class="s2">     81      0.0      1.0</span>
<span class="s2">END</span>
<span class="s2">&quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">+=</span> <span class="n">_add_imd_blocks</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span></div>


<div class="viewcode-block" id="get_short_TI_imd"><a class="viewcode-back" href="../../../../../SMArt.md.gromos.md_functions.html#SMArt.md.gromos.md_functions.make_imd.get_short_TI_imd">[docs]</a><span class="k">def</span> <span class="nf">get_short_TI_imd</span><span class="p">(</span><span class="n">n_atoms</span><span class="p">,</span> <span class="n">nW</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;TITLE</span>
<span class="s2">equilibration of the peptide in water</span>
<span class="s2">END</span>
<span class="s2"># we have 1 solute and 908 solvent molecules</span>
<span class="s2">SYSTEM</span>
<span class="s2">#      NPM      NSM</span>
<span class="s2">         1      &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nW</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">END</span>
<span class="s2"># most of this block is overwritten by mkscript.</span>
<span class="s2">INITIALISE</span>
<span class="s2">#    NTIVEL   NTISHK   NTINHT    NTINHB    NTISHI  NTIRTC     NTICOM   NTISTI      IG     TEMPI</span>
<span class="s2">         0         0        0         0         1       0          0        0  210185       0.0</span>
<span class="s2">END</span>
<span class="s2"># do 50000 steps</span>
<span class="s2">STEP</span>
<span class="s2">#   NSTLIM         T        DT</span>
<span class="s2">      5000       0.0     0.002</span>
<span class="s2">END</span>
<span class="s2"># do it with rectangular periodic boundary conditions</span>
<span class="s2">BOUNDCOND</span>
<span class="s2">#      NTB     NDFMIN</span>
<span class="s2">         1         3</span>
<span class="s2">END</span>
<span class="s2"># couple the temperature, the temperatures are overwritten by mkscript.</span>
<span class="s2">MULTIBATH</span>
<span class="s2"># ALGORITHM:</span>
<span class="s2">#      weak-coupling(0):      use weak-coupling scheme</span>
<span class="s2">#      nose-hoover(1):        use Nose Hoover scheme</span>
<span class="s2">#      nose-hoover-chains(2): use Nose Hoover chains scheme</span>
<span class="s2"># NUM: number of chains in Nose Hoover chains scheme</span>
<span class="s2">#      !! only specify NUM when needed !!</span>
<span class="s2"># NBATHS: number of temperature baths to couple to</span>
<span class="s2">#          ALGORITHM</span>
<span class="s2">                   0</span>
<span class="s2">#  NBATHS</span>
<span class="s2">         2</span>
<span class="s2"># TEMP0(1 ... NBATHS)  TAU(1 ... NBATHS)</span>
<span class="s2">       300     0.1     300     0.1</span>
<span class="s2">#   DOFSET: number of distiguishable sets of d.o.f.</span>
<span class="s2">         2</span>
<span class="s2"># LAST(1 ... DOFSET)  COMBATH(1 ... DOFSET)  IRBATH(1 ... DOFSET)</span>
<span class="s2">       &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n_atoms</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;         1         1       &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nW</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">n_atoms</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;         2         2</span>
<span class="s2">END</span>
<span class="s2">PRESSURESCALE</span>
<span class="s2"># COUPLE   SCALE    COMP    TAUP  VIRIAL</span>
<span class="s2">       2       1 0.0004575      0.5       2</span>
<span class="s2"># SEMI</span>
<span class="s2">       1       1       1</span>
<span class="s2"># PRES0(1...3,1...3)</span>
<span class="s2"> 0.06102       0       0</span>
<span class="s2">       0 0.06102       0</span>
<span class="s2">       0       0 0.06102</span>
<span class="s2">END</span>
<span class="s2"># every 1000 step we remove only the translational com motion</span>
<span class="s2">COMTRANSROT</span>
<span class="s2">#   NSCM</span>
<span class="s2">    1000</span>
<span class="s2">END</span>
<span class="s2">COVALENTFORM</span>
<span class="s2"># NTBBH: 0,1 controls bond-stretching potential</span>
<span class="s2">#        0: quartic form (default)</span>
<span class="s2">#        1: harmonic form</span>
<span class="s2"># NTBAH: 0,1 controls bond-angle bending potential</span>
<span class="s2">#        0: cosine-harmonic (default)</span>
<span class="s2">#        1: harmonic</span>
<span class="s2"># NTBDN: 0,1 controls torsional dihedral potential</span>
<span class="s2">#        0: arbitrary phase shifts (default)</span>
<span class="s2">#        1: phase shifts limited to 0 and 180 degrees.</span>
<span class="s2">#   NTBBH    NTBAH    NTBDN</span>
<span class="s2">        0        0        0</span>
<span class="s2">END</span>
<span class="s2"># every 250 steps write the energy and coordinates to the</span>
<span class="s2"># trajectory</span>
<span class="s2">WRITETRAJ</span>
<span class="s2"># NTWSE = configuration selection parameter</span>
<span class="s2"># =0: write normal trajectory</span>
<span class="s2"># &gt;0: chose min energy for writing configurations</span>
<span class="s2">#     NTWX     NTWSE      NTWV      NTWF    NTWE      NTWG      NTWB</span>
<span class="s2">      5000         0         0         0    5000         0         0</span>
<span class="s2">END</span>
<span class="s2"># every 250 steps print the energy in the output file.</span>
<span class="s2">PRINTOUT</span>
<span class="s2">#NTPR: print out energies, etc. every NTPR steps</span>
<span class="s2">#NTPP: =1 perform dihedral angle transition monitoring</span>
<span class="s2">#     NTPR     NTPP</span>
<span class="s2">      5000        0</span>
<span class="s2">END</span>
<span class="s2"># calculate the energies between the peptide, the ions and the solvent.</span>
<span class="s2">FORCE</span>
<span class="s2"> # NTF(1..6): 0,1 determines terms used in force calculation</span>
<span class="s2">#             0: do not include terms</span>
<span class="s2">#             1: include terms</span>
<span class="s2"># NEGR: ABS(NEGR): number of energy groups</span>
<span class="s2">#             &gt; 0: use energy groups</span>
<span class="s2">#             &lt; 0: use energy and force groups</span>
<span class="s2"># NRE(1..NEGR): &gt;= 1.0 last atom in each energy group</span>
<span class="s2"># NTF(1) NTF(2) NTF(3) NTF(4) NTF(5)        NTF(6)</span>
<span class="s2"># bonds     angles    improper  dihedral  electrostatic vdW</span>
<span class="s2">  0         1         1         1         1             1</span>
<span class="s2"># NEGR    NRE(1)    NRE(2)    ...      NRE(NEGR)</span>
<span class="s2">     2      &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n_atoms</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;    &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nW</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">n_atoms</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">END</span>
<span class="s2"># use the shake algorithm to constrain the bond lengths.</span>
<span class="s2">CONSTRAINT</span>
<span class="s2">#      NTC       NTCP   NTCP0(1)     NTCS      NTCS0(1)</span>
<span class="s2">         3          1    0.00010       4</span>
<span class="s2">END</span>
<span class="s2"># use grid based pairlist generation to speed up</span>
<span class="s2">PAIRLIST</span>
<span class="s2">#	algorithm: standard(0) (gromos96 like pairlist)</span>
<span class="s2">#		             grid(1) (XX grid pairlist)</span>
<span class="s2">#	SIZE:	   grid cell size (or auto = 0.5 * RCUTP)</span>
<span class="s2">#	TYPE:	   chargegoup(0) (chargegroup based cutoff)</span>
<span class="s2">#			         atomic(1) (atom based cutoff)</span>
<span class="s2">#</span>
<span class="s2">#	algorithm	  NSNB	RCUTP	RCUTL	  SIZE	TYPE</span>
<span class="s2">	        1	   5	  0.8	  1.4	   0.4	   0</span>
<span class="s2">END</span>
<span class="s2"># Longrange reaction field correction</span>
<span class="s2">NONBONDED</span>
<span class="s2"># NLRELE    APPAK      RCRF     EPSRF   NSLFEXCL</span>
<span class="s2">       1      0.0       1.4        61    1</span>
<span class="s2"># NSHAPE   ASHAPE    NA2CLC   TOLA2   EPSLS</span>
<span class="s2">      -1       1.4        2   1e-10       0</span>
<span class="s2"># NKX    NKY   NKZ    KCUT</span>
<span class="s2">   10     10    10     100</span>
<span class="s2"># NGX   NGY   NGZ  NASORD  NFDORD   NALIAS  NSPORD</span>
<span class="s2">   32    32    32       3       2        3       4</span>
<span class="s2"># NQEVAL   FACCUR   NRDGRD   NWRGRD   NLRLJ    SLVDNS</span>
<span class="s2">  100000      1.6        0        0       0      33.3</span>
<span class="s2">END</span>
<span class="s2">INNERLOOP</span>
<span class="s2">         2         1         0</span>
<span class="s2">END</span>
<span class="s2">POSITIONRES</span>
<span class="s2"># values for NTPOR:</span>
<span class="s2">#  0: no position re(con)straining</span>
<span class="s2">#  1: use CPOR</span>
<span class="s2">#  2: use SPOR/ ATOMIC B-FACTORS</span>
<span class="s2">#  3: position constraining</span>
<span class="s2"># NTPOR       NTPORB     NTPORS      CPOR</span>
<span class="s2">      1            1          0        50</span>
<span class="s2">END</span>
<span class="s2">PERTURBATION</span>
<span class="s2">#    NTG: 0..1 controls use of free-energy calculation.</span>
<span class="s2">#         0: no free-energy calculation (default)</span>
<span class="s2">#         1: calculate dH/dRLAM</span>
<span class="s2">#  NRDGL: 0,1 controls reading of initial value for RLAM.</span>
<span class="s2">#         0: use initial RLAM parameter from PERTURBATION block</span>
<span class="s2">#         1: read from configuration</span>
<span class="s2">#   RLAM: 0.0..1.0 initial value for lambda</span>
<span class="s2">#  DLAMT: &gt;= 0.0 rate of lambda increase in time.</span>
<span class="s2"># ALPHLJ: &gt;= 0.0 Lennard-Jones soft-core parameter</span>
<span class="s2">#  ALPHC: &gt;= 0.0 Coulomb-RF soft-core parameter</span>
<span class="s2">#   NLAM: &gt; 0 power dependence of lambda coupling</span>
<span class="s2"># NSCALE: 0..2 controls use of interaction scaling</span>
<span class="s2">#         0: no interaction scaling</span>
<span class="s2">#         1: interaction scaling</span>
<span class="s2">#         2: perturbation for all atom pairs with scaled</span>
<span class="s2">#            interactions. No perturbation for others.</span>
<span class="s2">#</span>
<span class="s2">#     NTG   NRDGL    RLAM   DLAMT</span>
<span class="s2">        1       0     0.0     0.1</span>
<span class="s2">#  ALPHLJ   ALPHC    NLAM  NSCALE</span>
<span class="s2">      0.5     0.5       1       0</span>
<span class="s2">END</span>
<span class="s2">&quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">+=</span> <span class="n">_add_imd_blocks</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Drazen Petrov.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>